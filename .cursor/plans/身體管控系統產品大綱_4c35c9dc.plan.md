---
name: 身體管控系統產品大綱
overview: 建立一個基於 React + Python 的身體管控網頁應用，包含飲食記錄、運動記錄、數據視覺化等核心功能，幫助用戶掌握一整天的飲食和運動情況。
todos: []
---

# 身體管控 AI Agent 系統 - 產品大綱

## 一、產品概述

一個以對話式 AI Agent 為核心的身體管控系統，用戶通過自然語言對話記錄飲食和運動，AI 助手（基於 Gemini 2.5 Flash）提供健康諮詢、實時統計分析，並自動生成每日健康報告。

## 二、技術架構

### 前端

- **框架**: React (使用 Vite)
- **部署**: GitHub Pages（靜態網站託管）
- **UI 庫**: Tailwind CSS（現代簡約風格）
- **對話界面**: 自定義聊天組件（類似 ChatGPT 風格）
- **圖表庫**: Recharts（用於報告視覺化）
- **狀態管理**: React Context API 或 Zustand
- **HTTP 客戶端**: Axios（支持 SSE 流式響應）
- **構建配置**: 需要配置 Vite 的 base path 以適配 GitHub Pages

### 後端

- **框架**: Python FastAPI（支持異步和流式響應）
- **開發環境**: 本地開發（地端構建）
- **部署**: Google Cloud Run（容器化部署）
- **AI 模型**: Google Gemini 2.5 Flash API
- **Agent 框架**: LangGraph（構建有狀態的多步驟 Agent）
- **LLM 框架**: LangChain（整合 Gemini 模型和工具）
- **資料庫**: 
  - **開發環境**: SQLite（本地文件數據庫，無需額外設置）
  - **生產環境**: PostgreSQL（Cloud SQL 或 Cloud Run 連接的外部 PostgreSQL）
- **ORM**: SQLAlchemy（支持 SQLite 和 PostgreSQL）
- **API**: RESTful API + Server-Sent Events (SSE) 用於流式對話

### 部署方案：Google Cloud Run

**開發流程**:

1. **本地開發**: 在本地環境構建和測試整個應用
2. **容器化**: 使用 Docker 將後端應用容器化
3. **部署**: 推送到 Google Cloud Run

**Cloud Run 優勢**:

- **按需付費**: 僅在處理請求時計費，無請求時不產生費用
- **自動擴展**: 根據流量自動調整實例數量
- **成本效益**: 免費額度充足（每月 200 萬次請求，360,000 GB-秒，180,000 vCPU-秒）
- **易於部署**: 支持從容器映像或源代碼直接部署
- **環境變數**: 支持設置環境變數和密鑰管理

**部署準備**:

- 創建 `Dockerfile` 用於後端容器化
- 創建 `cloudbuild.yaml` 或使用 `gcloud` CLI 部署
- 設置環境變數（Gemini API key、數據庫連接字符串等）
- 配置 CORS 允許 GitHub Pages 域名訪問

**數據庫選擇**:

- **SQLite**: 適合本地開發，無需額外服務，數據存儲在本地文件
- **PostgreSQL**: 生產環境推薦，可選擇：
  - Cloud SQL（Google 託管，自動備份）
  - 外部 PostgreSQL 服務（如 Supabase、Neon 等提供免費層）

### 資料庫設計

- **用戶表** (users): id, username, email, password_hash, created_at
- **對話記錄表** (conversations): id, user_id, date, created_at
- **訊息表** (messages): id, conversation_id, role (user/assistant), content, created_at
- **飲食記錄表** (diet_logs): id, user_id, date, meal_type, food_name, calories, protein, carbs, fat, created_at
- **運動記錄表** (exercise_logs): id, user_id, date, exercise_type, duration, calories_burned, created_at
- **每日報告表** (daily_reports): id, user_id, date, report_content (JSON), created_at

## 三、核心功能模組

### 1. AI 對話 Agent 模組

- **功能**:
  - 自然語言對話界面（主要交互方式）
  - 整合 Gemini 2.5 Flash 模型
  - 流式響應（實時顯示 AI 回覆）
  - 對話歷史記錄
  - 支持多輪對話上下文

### 2. 智能記錄提取模組

- **功能**:
  - 從對話中自動識別飲食資訊（食物名稱、份量、時間）
  - 從對話中自動識別運動資訊（運動類型、時長、強度）
  - 使用 AI 估算營養成分和卡路里
  - 自動儲存到資料庫
  - 支持用戶確認或修正提取的資訊

### 3. 實時統計分析模組

- **功能**:
  - 實時計算今日總攝入卡路里
  - 實時計算今日總消耗卡路里
  - 營養成分統計（蛋白質、碳水、脂肪）
  - 運動類型統計
  - 數據可隨時通過對話查詢

### 4. 健康諮詢 Agent

- **功能**:
  - 回答運動相關問題（運動建議、訓練計劃）
  - 回答飲食相關問題（營養建議、食物搭配）
  - 回答健康相關問題（基於用戶的記錄數據）
  - 提供個性化建議（結合用戶歷史數據）

### 5. 每日報告生成模組

- **功能**:
  - 自動整理一整天的飲食和運動記錄
  - 使用 AI 生成結構化報告（文字 + 數據）
  - 包含：總卡路里、營養分析、運動總結、健康建議
  - 支持查看歷史報告
  - 可通過對話請求生成報告

### 6. 用戶認證

- **功能**:
  - 用戶註冊
  - 用戶登入/登出
  - Session 管理

## 四、頁面結構

1. **登入/註冊頁** (`/login`, `/register`)
2. **主對話頁** (`/chat`) - 核心對話界面（主要頁面）

   - 左側：對話歷史列表（可選）
   - 中間：對話視窗（主要區域）
   - 右側：今日統計卡片（可選，可收起）

3. **報告查看頁** (`/reports`) - 查看歷史報告和數據視覺化

## 五、UI/UX 設計原則

- **對話優先**: 對話視窗是主要交互方式，佔據大部分螢幕空間
- **現代簡約**: 類似 ChatGPT 的對話界面設計
- **實時反饋**: 流式顯示 AI 回應，提供即時體驗
- **智能提示**: AI 主動提供記錄建議和健康提醒
- **響應式設計**: 支持手機和桌面端，對話界面適配不同螢幕

## 六、開發階段規劃

### Phase 1: 基礎架構

- 設置 React 前端專案
- 設置 Python 後端專案
- 設計並建立資料庫結構
- 實現用戶認證系統

### Phase 2: 核心功能

- 實現飲食記錄 CRUD 功能
- 實現運動記錄 CRUD 功能
- 建立 API 端點

### Phase 3: 數據視覺化

- 實現儀表板頁面
- 整合圖表庫，顯示統計數據
- 實現日期篩選功能

### Phase 4: 優化與完善

- UI/UX 優化
- 錯誤處理
- 數據驗證
- 響應式設計調整

## 七、專案結構

```
fitness/
├── frontend/          # React 前端
│   ├── src/
│   │   ├── components/
│   │   ├── pages/
│   │   ├── services/
│   │   ├── context/
│   │   └── App.jsx
│   └── package.json
├── backend/           # Python 後端
│   ├── app/
│   │   ├── models/
│   │   ├── routes/
│   │   ├── auth/
│   │   └── __init__.py
│   ├── requirements.txt
│   └── run.py
└── README.md
```

## 八、後續擴展功能（可選）

- 體重追蹤
- 目標設定（每日卡路里目標、運動目標）
- 食物資料庫（自動填充營養資訊）
- 運動資料庫（自動計算消耗卡路里）
- 數據匯出功能
- 提醒通知功能